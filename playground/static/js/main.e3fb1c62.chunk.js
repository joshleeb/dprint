(this.webpackJsonpplayground=this.webpackJsonpplayground||[]).push([[3],{29:function(e,t,n){var r=n(63),o=[];e.exports=function(){var e=new Worker(n.p+"b39be745c0f9e887b44f.worker.js",{name:"[hash].worker.js"});return r(e,o),e}},64:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var r=n(5),o=n(0),i=n.n(o),a=n(27),c=n.n(a),s=n(7),l=n(9),u=n(10),d=n(11),f=n(20),p=n(21),h=n(28),g=n(2);function j(e){var t=e.backgroundColor;return Object(g.jsx)("div",{className:"verticallyCenter horizontallyCenter fillHeight",style:{backgroundColor:t},children:Object(g.jsx)(h.BeatLoader,{color:"#fff",loading:!0,size:25})})}var b=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e){var o;Object(l.a)(this,r),(o=t.call(this,e)).editor=void 0,o.monacoEditor=void 0,o.outerContainerRef=i.a.createRef(),o.disposables=[],o.lastScrollTop=0,o.state={editorComponent:void 0},o.editorDidMount=o.editorDidMount.bind(Object(d.a)(o));var a=Promise.all([n.e(0),n.e(82)]).then(n.bind(null,508));return Promise.all([n.e(0),n.e(6)]).then(n.t.bind(null,436,7)).then((function(e){o.monacoEditor=e,"typescript"===o.props.language&&(e.languages.typescript.typescriptDefaults.setCompilerOptions({noLib:!0,target:e.languages.typescript.ScriptTarget.ESNext,allowNonTsExtensions:!0}),e.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSyntaxValidation:!0,noSemanticValidation:!0})),e.editor.defineTheme("dprint-theme",{base:"vs-dark",inherit:!0,rules:[],colors:{"editorRuler.foreground":"#283430"}}),a.then((function(e){o.setState({editorComponent:e.default})})).catch((function(e){console.error(e),o.setState({editorComponent:!1})}))})).catch((function(e){console.error(e),o.setState({editorComponent:!1})})),o}return Object(u.a)(r,[{key:"render",value:function(){return this.updateScrollTop(),this.updateJsonSchema(),Object(g.jsx)("div",{className:"codeEditor",ref:this.outerContainerRef,children:this.getEditor()})}},{key:"componentWillUnmount",value:function(){var e,t=Object(s.a)(this.disposables);try{for(t.s();!(e=t.n()).done;){e.value.dispose()}}catch(n){t.e(n)}finally{t.f()}this.disposables.length=0}},{key:"getEditor",value:function(){var e=this;return null==this.state.editorComponent?Object(g.jsx)(j,{backgroundColor:"#1e1e1e"}):!1===this.state.editorComponent?Object(g.jsx)("div",{className:"errorMessage",children:"Error loading code editor. Please refresh the page to try again."}):Object(g.jsx)(this.state.editorComponent,{width:"100%",height:"100%",value:this.props.text,theme:"dprint-theme",language:this.props.language,onChange:function(t){return e.props.onChange&&e.props.onChange(t)},editorDidMount:this.editorDidMount,options:{automaticLayout:!1,renderWhitespace:"all",readOnly:this.props.readonly||!1,minimap:{enabled:!1},quickSuggestions:!1,rulers:null==this.props.lineWidth?[]:[this.props.lineWidth]}})}},{key:"editorDidMount",value:function(e){var t=this;this.editor=e,this.disposables.push(this.editor.onDidChangeModelContent((function(){t.props.readonly&&t.editor.setPosition({column:1,lineNumber:1})}))),this.disposables.push(this.editor.onDidScrollChange((function(e){e.scrollTopChanged&&t.props.onScrollTopChange&&t.props.onScrollTopChange(e.scrollTop)})));var n=0,r=0,o=setInterval((function(){var o=t.outerContainerRef.current;if(null!=o){var i=o.offsetWidth,a=o.offsetHeight;n===a&&r===i||(e.layout(),n=a,r=i)}}),500);this.disposables.push({dispose:function(){return clearInterval(o)}})}},{key:"updateScrollTop",value:function(){var e=this;null!=this.editor&&this.lastScrollTop!==this.props.scrollTop&&setTimeout((function(){null!=e.props.scrollTop&&(e.editor.setScrollTop(e.props.scrollTop),e.lastScrollTop=e.props.scrollTop)}),0)}},{key:"updateJsonSchema",value:function(){var e,t;null!=this.monacoEditor&&null!=this.props.jsonSchemaUrl&&((null===(e=this.monacoEditor.languages.json.jsonDefaults.diagnosticsOptions.schemas)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.uri)!==this.props.jsonSchemaUrl&&this.monacoEditor.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,allowComments:!0,enableSchemaRequest:!0,schemas:[{uri:this.props.jsonSchemaUrl,fileMatch:["*"]}]}))}}]),r}(i.a.Component);function v(e){return Object(g.jsx)("a",{id:e.id,href:e.url,rel:"noopener noreferrer",children:e.text})}var m=n(29),x=n.n(m)()(),O=[],y=[],S=[];x.addEventListener("message",(function(e){switch(e.data.type){case"PluginInfo":var t,n=Object(s.a)(O);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e.data.info)}}catch(c){n.e(c)}finally{n.f()}break;case"Format":var r,o=Object(s.a)(y);try{for(o.s();!(r=o.n()).done;){(0,r.value)(e.data.text)}}catch(c){o.e(c)}finally{o.f()}break;case"Error":var i,a=Object(s.a)(S);try{for(a.s();!(i=a.n()).done;){(0,i.value)(e.data.message)}}catch(c){a.e(c)}finally{a.f()}}}));n(64);var w=n(15),T=(n(68),n(69),n(8)),C=n.n(T),k=n(13);function E(){return(E=Object(k.a)(C.a.mark((function e(t,n){var r,o,i,a,c,s,l,u,d,f;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return","{\n}\n");case 2:return e.prev=2,e.next=5,fetch(t,{signal:n});case 5:return r=e.sent,e.next=8,r.json();case 8:o=e.sent,i="{",a=!1,c=0,s=Object.keys(o.properties);case 12:if(!(c<s.length)){e.next=23;break}if("$schema"!==(l=s[c])&&"deno"!==l&&"locked"!==l){e.next=16;break}return e.abrupt("continue",20);case 16:u=o.properties[l],d=void 0,null!=(d=u.$ref?null===(f=o.definitions[l])||void 0===f?void 0:f.default:u.default)&&(i+=a?",\n":"\n",i+='  "'.concat(l,'": '),i+="string"===typeof d?'"'.concat(d,'"'):"lineWidth"===l?"80":"".concat(d.toString()),a=!0);case 20:c++,e.next=12;break;case 23:return i+="\n}\n",e.abrupt("return",i);case 27:if(e.prev=27,e.t0=e.catch(2),!n.aborted){e.next=31;break}throw e.t0;case 31:return e.abrupt("return","{\n  // error resolving schema: ".concat(null===e.t0||void 0===e.t0?void 0:e.t0.toString(),"\n}\n"));case 32:case"end":return e.stop()}}),e,null,[[2,27]])})))).apply(this,arguments)}function N(){return(N=Object(k.a)(C.a.mark((function e(t){var n,r,o,i,a,c,s;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://plugins.dprint.dev/info.json",{signal:t});case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,4,4===r.schemaVersion){e.next=9;break}throw new Error("Expected schema version ".concat(4,", but found ").concat(r.schemaVersion,"."));case 9:return o=r.latest.find((function(e){return"typescript"===e.configKey})),i=r.latest.find((function(e){return"json"===e.configKey})),a=r.latest.find((function(e){return"markdown"===e.configKey})),c=r.latest.find((function(e){return"toml"===e.configKey})),s=r.latest.find((function(e){return"dockerfile"===e.configKey})),e.abrupt("return",[o.url,i.url,a.url,c.url,s.url]);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){var t=/https:\/\/plugins\.dprint\.dev\/([a-z]+)-[0-9]+\.[0-9]+\.[0-9]+\.wasm$/.exec(e),n=null===t||void 0===t?void 0:t[1];switch(n){case"typescript":case"markdown":case"json":case"toml":case"dockerfile":return n;default:return}}function P(e){var t=e.configText,n=e.onConfigTextChanged,i=e.text,a=e.onTextChanged,c=e.formattedText,s=e.selectedPluginUrl,l=e.selectedPluginInfo,u=e.pluginUrls,d=e.onSelectPluginUrl,f=e.isLoading,p=Object(o.useState)(0),h=Object(r.a)(p,2),m=h[0],O=h[1],y=Object(o.useState)(void 0),S=Object(r.a)(y,2),T=S[0],C=S[1];Object(o.useEffect)((function(){C(l.fileExtensions[0])}),[l]),Object(o.useEffect)((function(){var e=setTimeout((function(){var e,t,n;t=null!==(e="file."+T)&&void 0!==e?e:"ts",n=i,x.postMessage({type:"Format",filePath:t,fileText:n})}),250);return function(){return clearTimeout(e)}}),[T,i]),Object(o.useEffect)((function(){var e=setTimeout((function(){var e;try{null==(e=JSON.parse(t)).lineWidth&&(e.lineWidth=80),function(e){x.postMessage({type:"SetConfig",config:e})}(e)}catch(n){}}),250);return function(){return clearTimeout(e)}}),[t]);var k=Object(o.useMemo)((function(){try{var e=parseInt(JSON.parse(t).lineWidth,10);if(!isNaN(e))return e}catch(n){}return 80}),[t]),E=Object(o.useCallback)((function(e){C(e.target.value)}),[C]);return Object(g.jsx)("div",{className:"App",children:Object(g.jsxs)(w.a,{split:"horizontal",defaultSize:53,allowResize:!1,children:[Object(g.jsxs)("header",{className:"appHeader",children:[Object(g.jsx)("h1",{id:"title",children:"dprint - Playground"}),Object(g.jsxs)("div",{id:"headerRight",children:[Object(g.jsx)("a",{href:"/overview",children:"Overview"}),Object(g.jsx)("a",{href:"/playground",children:"Playground"}),Object(g.jsx)("a",{href:"/sponsor",children:"Sponsor"}),Object(g.jsx)(v,{url:"https://github.com/dprint/dprint",text:"View on GitHub"})]})]}),Object(g.jsxs)(w.a,{split:"vertical",minSize:50,defaultSize:"50%",allowResize:!0,pane1Style:{overflowX:"hidden",overflowY:"hidden"},pane2Style:{overflowX:"hidden",overflowY:"hidden"},children:[Object(g.jsxs)(w.a,{split:"horizontal",allowResize:!0,defaultSize:"60%",pane1Style:{overflowX:"hidden",overflowY:"hidden"},pane2Style:{overflowX:"hidden",overflowY:"hidden"},children:[Object(g.jsxs)("div",{className:"container",children:[Object(g.jsx)("div",{className:"playgroundSubTitle",children:Object(g.jsxs)("div",{className:"row",children:[Object(g.jsx)("div",{className:"column",children:"Plugin:"}),Object(g.jsx)("div",{className:"column",style:{flex:1,display:"flex"},children:Object(g.jsx)("select",{onChange:function(e){return d(u[e.target.selectedIndex])},style:{flex:1},value:s,children:u.map((function(e,t){return Object(g.jsx)("option",{value:e,children:e},t)}))})}),Object(g.jsx)("div",{className:"column",style:{display:"flex"},children:Object(g.jsx)("select",{value:T,onChange:E,children:l.fileExtensions.map((function(e,t){return Object(g.jsxs)("option",{value:e,children:[".",e]},t)}))})})]})}),Object(g.jsx)(b,{language:U(s),onChange:a,text:i,lineWidth:k,onScrollTopChange:O,scrollTop:m})]}),Object(g.jsxs)("div",{className:"container",children:[Object(g.jsx)("div",{className:"playgroundSubTitle",children:"Configuration"}),Object(g.jsx)(b,{language:"json",onChange:n,jsonSchemaUrl:null===l||void 0===l?void 0:l.configSchemaUrl,text:t})]})]}),Object(g.jsx)("div",{className:"container",children:f?Object(g.jsx)(j,{}):Object(g.jsx)(b,{language:U(s),text:c,readonly:!0,lineWidth:k,onScrollTopChange:O,scrollTop:m})})]})]})})}var D=n(14);function I(e){return Object(D.decompressFromEncodedURIComponent)(e.trim())||""}var R=new(function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,[{key:"getUrlInfo",value:function(){var e=document.location.hash||"";return{text:function(){var t=/code\/([^/]+)/.exec(e);if(null==t||2!==t.length)return"";try{return I(t[1])}catch(n){return console.error(n),""}}(),configText:function(){var t=/config\/([^/]+)/.exec(e);if(null==t||2!==t.length)return;try{return I(t[1])}catch(n){return void console.error(n)}}(),language:function(){var t=/language\/([^/]+)/.exec(e);if(null==t||2!==t.length)return"typescript";try{switch(t[1]){case"json":return"json";case"markdown":return"markdown";case"toml":return"toml";case"dockerfile":return"dockerfile";case"typescript":default:return"typescript"}}catch(n){return console.error(n),"typescript"}}()}}},{key:"updateUrl",value:function(e){var t=e.text,n=e.configText,r=e.language;if(null==r)window.history.replaceState(void 0,"","");else{var o="#code/".concat(Object(D.compressToEncodedURIComponent)(t));null!=n&&(o+="/config/".concat(Object(D.compressToEncodedURIComponent)(n))),o+="/language/".concat(r),window.history.replaceState(void 0,"",o)}}}]),e}()),z=R.getUrlInfo(),M=!0;function W(){var e,t=Object(o.useState)([]),n=Object(r.a)(t,2),i=n[0],a=n[1],c=Object(o.useState)(),s=Object(r.a)(c,2),l=s[0],u=s[1],d=Object(o.useState)(),f=Object(r.a)(d,2),p=f[0],h=f[1],b=Object(o.useState)(z.text),v=Object(r.a)(b,2),m=v[0],w=v[1],T=Object(o.useState)(null!==(e=z.configText)&&void 0!==e?e:""),C=Object(r.a)(T,2),k=C[0],D=C[1],I=Object(o.useState)(""),W=Object(r.a)(I,2),L=W[0],J=W[1],K=Object(o.useState)(""),V=Object(r.a)(K,2),H=V[0],X=V[1],Y=Object(o.useState)(!0),A=Object(r.a)(Y,2),F=A[0],$=A[1];return Object(o.useEffect)((function(){var e=new AbortController;return function(e){return N.apply(this,arguments)}(e.signal).then((function(e){a(e),u(e.find((function(e){var t;return U(e)===(null!==(t=z.language)&&void 0!==t?t:"typescript")})))})).catch((function(t){e.signal.aborted||(console.error(t),alert("There was an error getting the plugins. Try refreshing the page or check the browser console."))})),function(){e.abort()}}),[]),Object(o.useEffect)((function(){var e;return e=t,O.push(e),function(e){y.push(e)}(n),function(e){S.push(e)}(r),function(){!function(e){var t=O.indexOf(e);t>=0&&O.splice(t,1)}(t),function(e){var t=S.indexOf(e);t>=0&&S.splice(t,1)}(r),function(e){var t=y.indexOf(e);t>=0&&y.splice(t,1)}(n)};function t(e){h(e)}function n(e){X(e)}function r(e){console.error(e),alert("There was an error with the formatter worker. Try refreshing the page or check the browser console.")}}),[X,h]),Object(o.useEffect)((function(){null!=l&&R.updateUrl({text:m,configText:k===L?void 0:k,language:U(l)})}),[m,k,l,L]),Object(o.useEffect)((function(){var e;($(!0),null!=l)&&(e=l,x.postMessage({type:"LoadUrl",url:e}))}),[l]),Object(o.useEffect)((function(){if(null!=l&&null!=p){var e=new AbortController;return function(e,t){return E.apply(this,arguments)}(p.configSchemaUrl,e.signal).then((function(e){M&&null!=z.configText?(D(z.configText),M=!1):D(e),J(e),$(!1)})).catch((function(t){e.signal.aborted||(console.error(t),alert("There was an error loading the plugin. Check the console or try refreshing the page."))})),function(){e.abort()}}}),[l,p]),null==l||null==p?Object(g.jsx)(j,{}):Object(g.jsx)(P,{text:m,onTextChanged:w,configText:k,onConfigTextChanged:D,formattedText:H,pluginUrls:i,selectedPluginUrl:l,selectedPluginInfo:p,onSelectPluginUrl:function(e){h(void 0),u(e)},isLoading:F})}c.a.render(Object(g.jsx)(W,{}),document.getElementById("root"))}},[[71,4,5]]]);
//# sourceMappingURL=main.e3fb1c62.chunk.js.map