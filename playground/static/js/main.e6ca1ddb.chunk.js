(this.webpackJsonpplayground=this.webpackJsonpplayground||[]).push([[3],{31:function(e,t,n){var o=n(65),r=[];e.exports=function(){var e=new Worker(n.p+"89f106a825f6f01bdff1.worker.js",{name:"[hash].worker.js"});return o(e,r),e}},66:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},73:function(e,t,n){"use strict";n.r(t);var o,r=n(22),i=n(5),a=n(0),s=n.n(a),c=n(29),l=n.n(c),u=n(9),d=n(11),p=n(12),h=n(13),f=n(20),g=n(21),j=n(30),v=n(2);function b(e){var t=e.backgroundColor;return Object(v.jsx)("div",{className:"verticallyCenter horizontallyCenter fillHeight",style:{backgroundColor:t},children:Object(v.jsx)(j.BeatLoader,{color:"#fff",loading:!0,size:25})})}!function(e){e.TypeScript="typescript",e.Json="json",e.Markdown="markdown",e.Toml="toml"}(o||(o={}));var m=function(e){Object(f.a)(r,e);var t=Object(g.a)(r);function r(e){var i;Object(d.a)(this,r),(i=t.call(this,e)).editor=void 0,i.monacoEditor=void 0,i.outerContainerRef=s.a.createRef(),i.disposables=[],i.lastScrollTop=0,i.state={editorComponent:void 0},i.editorDidMount=i.editorDidMount.bind(Object(h.a)(i));var a=Promise.all([n.e(0),n.e(82)]).then(n.bind(null,508));return Promise.all([n.e(0),n.e(6)]).then(n.t.bind(null,436,7)).then((function(e){i.monacoEditor=e,i.props.language===o.TypeScript&&(e.languages.typescript.typescriptDefaults.setCompilerOptions({noLib:!0,target:e.languages.typescript.ScriptTarget.ESNext,allowNonTsExtensions:!0}),e.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSyntaxValidation:!0,noSemanticValidation:!0})),e.editor.defineTheme("dprint-theme",{base:"vs-dark",inherit:!0,rules:[],colors:{"editorRuler.foreground":"#283430"}}),a.then((function(e){i.setState({editorComponent:e.default})})).catch((function(e){console.error(e),i.setState({editorComponent:!1})}))})).catch((function(e){console.error(e),i.setState({editorComponent:!1})})),i}return Object(p.a)(r,[{key:"render",value:function(){return this.updateScrollTop(),this.updateJsonSchema(),Object(v.jsx)("div",{className:"codeEditor",ref:this.outerContainerRef,children:this.getEditor()})}},{key:"componentWillUnmount",value:function(){var e,t=Object(u.a)(this.disposables);try{for(t.s();!(e=t.n()).done;){e.value.dispose()}}catch(n){t.e(n)}finally{t.f()}this.disposables.length=0}},{key:"getEditor",value:function(){var e=this;return null==this.state.editorComponent?Object(v.jsx)(b,{backgroundColor:"#1e1e1e"}):!1===this.state.editorComponent?Object(v.jsx)("div",{className:"errorMessage",children:"Error loading code editor. Please refresh the page to try again."}):Object(v.jsx)(this.state.editorComponent,{width:"100%",height:"100%",value:this.props.text,theme:"dprint-theme",language:this.props.language,onChange:function(t){return e.props.onChange&&e.props.onChange(t)},editorDidMount:this.editorDidMount,options:{automaticLayout:!1,renderWhitespace:"all",readOnly:this.props.readonly||!1,minimap:{enabled:!1},quickSuggestions:!1,rulers:null==this.props.lineWidth?[]:[this.props.lineWidth]}})}},{key:"editorDidMount",value:function(e){var t=this;this.editor=e,this.disposables.push(this.editor.onDidChangeModelContent((function(){t.props.readonly&&t.editor.setPosition({column:1,lineNumber:1})}))),this.disposables.push(this.editor.onDidScrollChange((function(e){e.scrollTopChanged&&t.props.onScrollTopChange&&t.props.onScrollTopChange(e.scrollTop)})));var n=0,o=0,r=setInterval((function(){var r=t.outerContainerRef.current;if(null!=r){var i=r.offsetWidth,a=r.offsetHeight;n===a&&o===i||(e.layout(),n=a,o=i)}}),500);this.disposables.push({dispose:function(){return clearInterval(r)}})}},{key:"updateScrollTop",value:function(){var e=this;null!=this.editor&&this.lastScrollTop!==this.props.scrollTop&&setTimeout((function(){null!=e.props.scrollTop&&(e.editor.setScrollTop(e.props.scrollTop),e.lastScrollTop=e.props.scrollTop)}),0)}},{key:"updateJsonSchema",value:function(){var e,t;null!=this.monacoEditor&&null!=this.props.jsonSchemaUrl&&((null===(e=this.monacoEditor.languages.json.jsonDefaults.diagnosticsOptions.schemas)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.uri)!==this.props.jsonSchemaUrl&&this.monacoEditor.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,allowComments:!0,enableSchemaRequest:!0,schemas:[{uri:this.props.jsonSchemaUrl,fileMatch:["*"]}]}))}}]),r}(s.a.Component);function x(e){return Object(v.jsx)("a",{id:e.id,href:e.url,rel:"noopener noreferrer",children:e.text})}var O=n(31),y=n.n(O)()(),S=[],T=[];y.addEventListener("message",(function(e){switch(e.data.type){case"Format":var t,n=Object(u.a)(S);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e.data.text)}}catch(i){n.e(i)}finally{n.f()}break;case"Error":var o,r=Object(u.a)(T);try{for(r.s();!(o=r.n()).done;){(0,o.value)(e.data.message)}}catch(i){r.e(i)}finally{r.f()}}}));n(66);var w=n(16);n(70),n(71);function C(e){var t=e.configText,n=e.onConfigTextChanged,r=e.text,s=e.onTextChanged,c=e.formattedText,l=e.fileExtensions,u=e.selectedPlugin,d=e.plugins,p=e.onSelectPlugin,h=e.isLoading,f=Object(a.useState)(0),g=Object(i.a)(f,2),j=g[0],O=g[1],S=Object(a.useState)(void 0),T=Object(i.a)(S,2),C=T[0],k=T[1];Object(a.useEffect)((function(){k(l[0])}),[l]),Object(a.useEffect)((function(){var e=setTimeout((function(){var e,t,n;t=null!==(e="file."+C)&&void 0!==e?e:"ts",n=r,y.postMessage({type:"Format",filePath:t,fileText:n})}),250);return function(){return clearTimeout(e)}}),[C,r]),Object(a.useEffect)((function(){var e=setTimeout((function(){var e;try{null==(e=JSON.parse(t)).lineWidth&&(e.lineWidth=80),function(e){y.postMessage({type:"SetConfig",config:e})}(e)}catch(n){}}),250);return function(){return clearTimeout(e)}}),[t]);var E=Object(a.useMemo)((function(){try{var e=parseInt(JSON.parse(t).lineWidth,10);if(!isNaN(e))return e}catch(n){}return 80}),[t]),N=Object(a.useCallback)((function(e){k(e.target.value)}),[k]);return Object(v.jsx)("div",{className:"App",children:Object(v.jsxs)(w.a,{split:"horizontal",defaultSize:53,allowResize:!1,children:[Object(v.jsxs)("header",{className:"appHeader",children:[Object(v.jsx)("h1",{id:"title",children:"dprint - Playground"}),Object(v.jsxs)("div",{id:"headerRight",children:[Object(v.jsx)("a",{href:"/overview",children:"Overview"}),Object(v.jsx)("a",{href:"/playground",children:"Playground"}),Object(v.jsx)("a",{href:"/sponsor",children:"Sponsor"}),Object(v.jsx)(x,{url:"https://github.com/dprint/dprint",text:"View on GitHub"})]})]}),Object(v.jsxs)(w.a,{split:"vertical",minSize:50,defaultSize:"50%",allowResize:!0,pane1Style:{overflowX:"hidden",overflowY:"hidden"},pane2Style:{overflowX:"hidden",overflowY:"hidden"},children:[Object(v.jsxs)(w.a,{split:"horizontal",allowResize:!0,defaultSize:"60%",pane1Style:{overflowX:"hidden",overflowY:"hidden"},pane2Style:{overflowX:"hidden",overflowY:"hidden"},children:[Object(v.jsxs)("div",{className:"container",children:[Object(v.jsx)("div",{className:"playgroundSubTitle",children:Object(v.jsxs)("div",{className:"row",children:[Object(v.jsx)("div",{className:"column",children:"Plugin:"}),Object(v.jsx)("div",{className:"column",style:{flex:1,display:"flex"},children:Object(v.jsx)("select",{onChange:function(e){return p(d[e.target.selectedIndex])},style:{flex:1},value:u.url,children:d.map((function(e,t){return Object(v.jsx)("option",{value:e.url,children:e.url},t)}))})}),Object(v.jsx)("div",{className:"column",style:{display:"flex"},children:Object(v.jsx)("select",{value:C,onChange:N,children:l.map((function(e,t){return Object(v.jsxs)("option",{value:e,children:[".",e]},t)}))})})]})}),Object(v.jsx)(m,{language:u.language,onChange:s,text:r,lineWidth:E,onScrollTopChange:O,scrollTop:j})]}),Object(v.jsxs)("div",{className:"container",children:[Object(v.jsx)("div",{className:"playgroundSubTitle",children:"Configuration"}),Object(v.jsx)(m,{language:o.Json,onChange:n,jsonSchemaUrl:u.configSchemaUrl,text:t})]})]}),Object(v.jsx)("div",{className:"container",children:h?Object(v.jsx)(b,{}):Object(v.jsx)(m,{language:u.language,text:c,readonly:!0,lineWidth:E,onScrollTopChange:O,scrollTop:j})})]})]})})}var k=n(7),E=n.n(k),N=n(14);function U(){return(U=Object(N.a)(E.a.mark((function e(t){var n,o,r,i,a,s,c,l,u,d;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t.configSchemaUrl);case 2:return n=e.sent,e.next=5,n.json();case 5:o=e.sent,r="{",i=!1,a=0,s=Object.keys(o.properties);case 9:if(!(a<s.length)){e.next=20;break}if("$schema"!==(c=s[a])&&"deno"!==c&&"locked"!==c){e.next=13;break}return e.abrupt("continue",17);case 13:l=o.properties[c],u=void 0,null!=(u=l.$ref?null===(d=o.definitions[c])||void 0===d?void 0:d.default:l.default)&&(r+=i?",\n":"\n",r+='  "'.concat(c,'": '),r+="string"===typeof u?'"'.concat(u,'"'):"lineWidth"===c?"80":"".concat(u.toString()),i=!0);case 17:a++,e.next=9;break;case 20:return r+="\n}\n",e.abrupt("return",r);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(N.a)(E.a.mark((function e(){var t,n,r,i,a,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://plugins.dprint.dev/info.json");case 2:return t=e.sent,e.next=5,t.json();case 5:if(n=e.sent,3,3===n.schemaVersion){e.next=9;break}throw new Error("Expected schema version ".concat(3,", but found ").concat(n.schemaVersion,"."));case 9:return r=n.latest.find((function(e){return"typescript"===e.configKey})),i=n.latest.find((function(e){return"json"===e.configKey})),a=n.latest.find((function(e){return"markdown"===e.configKey})),s=n.latest.find((function(e){return"toml"===e.configKey})),e.abrupt("return",[{url:r.url,configSchemaUrl:"https://plugins.dprint.dev/schemas/typescript-v0.json",language:o.TypeScript,fileExtensions:r.fileExtensions},{url:i.url,configSchemaUrl:"https://plugins.dprint.dev/schemas/json-v0.json",language:o.Json,fileExtensions:i.fileExtensions},{url:a.url,configSchemaUrl:"https://plugins.dprint.dev/schemas/markdown-v0.json",language:o.Markdown,fileExtensions:a.fileExtensions},{url:s.url,configSchemaUrl:"https://plugins.dprint.dev/schemas/toml-v0.json",language:o.Toml,fileExtensions:s.fileExtensions}]);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D=n(15);function R(e){return Object(D.decompressFromEncodedURIComponent)(e.trim())||""}var P=new(function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,[{key:"getUrlInfo",value:function(){var e=document.location.hash||"";return{text:function(){var t=/code\/([^/]+)/.exec(e);if(null==t||2!==t.length)return"";try{return R(t[1])}catch(n){return console.error(n),""}}(),configText:function(){var t=/config\/([^/]+)/.exec(e);if(null==t||2!==t.length)return;try{return R(t[1])}catch(n){return void console.error(n)}}(),language:function(){var t=/language\/([^/]+)/.exec(e);if(null==t||2!==t.length)return"typescript";try{switch(t[1]){case"json":return"json";case"markdown":return"markdown";case"toml":return"toml";case"typescript":default:return"typescript"}}catch(n){return console.error(n),"typescript"}}()}}},{key:"updateUrl",value:function(e){var t=e.text,n=e.configText,o=e.language;if(null==o)window.history.replaceState(void 0,"","");else{var r="#code/".concat(Object(D.compressToEncodedURIComponent)(t));null!=n&&(r+="/config/".concat(Object(D.compressToEncodedURIComponent)(n))),r+="/language/".concat(o),window.history.replaceState(void 0,"",r)}}}]),e}()),W=P.getUrlInfo(),z=!0;function I(){var e,t=Object(a.useState)([]),n=Object(i.a)(t,2),o=n[0],s=n[1],c=Object(a.useState)(),l=Object(i.a)(c,2),u=l[0],d=l[1],p=Object(a.useState)([]),h=Object(i.a)(p,2),f=h[0],g=h[1],j=Object(a.useState)(W.text),m=Object(i.a)(j,2),x=m[0],O=m[1],w=Object(a.useState)(null!==(e=W.configText)&&void 0!==e?e:""),k=Object(i.a)(w,2),E=k[0],N=k[1],D=Object(a.useState)(""),R=Object(i.a)(D,2),I=R[0],J=R[1],L=Object(a.useState)(""),V=Object(i.a)(L,2),H=V[0],K=V[1],X=Object(a.useState)(!0),Y=Object(i.a)(X,2),F=Y[0],q=Y[1];return Object(a.useEffect)((function(){(function(){return M.apply(this,arguments)})().then((function(e){s(e),d(e.find((function(e){var t;return null!==(t=e.language===W.language)&&void 0!==t?t:"typescript"})))})).catch((function(e){console.error(e),alert("There was an error getting the plugins. Try refreshing the page or check the browser console.")}))}),[]),Object(a.useEffect)((function(){var e;e=function(e){K(e)},S.push(e),function(e){T.push(e)}((function(e){console.error(e),alert("There was an error with the formatter worker. Try refreshing the page or check the browser console.")}))}),[]),Object(a.useEffect)((function(){null!=u&&P.updateUrl({text:x,configText:E===I?void 0:E,language:u.language})}),[x,E,u,I]),Object(a.useEffect)((function(){if(q(!0),null!=u){var e,t=function(e){return U.apply(this,arguments)}(u);e=u.url,y.postMessage({type:"LoadUrl",url:e}),t.then((function(e){g(Object(r.a)(u.fileExtensions)),z&&null!=W.configText?(N(W.configText),z=!1):N(e),J(e),q(!1)})).catch((function(e){console.error(e),alert("There was an error loading the plugin. Check the console or try refreshing the page.")}))}}),[u]),null==u?Object(v.jsx)(b,{}):Object(v.jsx)(C,{text:x,onTextChanged:O,configText:E,onConfigTextChanged:N,formattedText:H,fileExtensions:f,plugins:o,selectedPlugin:u,onSelectPlugin:d,isLoading:F})}l.a.render(Object(v.jsx)(I,{}),document.getElementById("root"))}},[[73,4,5]]]);
//# sourceMappingURL=main.e6ca1ddb.chunk.js.map